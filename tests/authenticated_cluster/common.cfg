all.sitename $name

set pwd = ${PWD}
set lib = @CMAKE_BINARY_DIR@/lib
set src = @CMAKE_CURRENT_SOURCE_DIR@

all.export /
oss.localroot $pwd/data/$name
all.adminpath $pwd
all.pidpath   $pwd


cms.conwait 1
cms.delay startup 2 lookup 1 qdl 2 suspend 1
cms.space linger 0 recalc 15 min 2% 1g 5% 2g
cms.sched cpu 50 io 50 affinity randomized fuzz 50

acc.authdb $src/scitokens.authdb

ofs.chkpnt enable
ofs.tpc streams 8 pgm @CMAKE_BINARY_DIR@/bin/xrdcp --server
ofs.ckslib zcrc32 $lib/libXrdCksCalczcrc32.so
ofs.authlib libXrdAccSciTokens.so config=$src/scitokens.cfg
ofs.authorize true

http.header2cgi Authorization authz

sec.protocol ztn
sec.protbind * only ztn

xrootd.chksum zcrc32 chkcgi adler32 crc32c
xrootd.seclib libXrdSec.so
xrootd.tls all
xrd.tlsca certfile @CMAKE_BINARY_DIR@/tests/issuer/tlsca.pem
xrd.tls @CMAKE_BINARY_DIR@/tests/issuer/tls.crt @CMAKE_BINARY_DIR@/tests/issuer/tls.key
xrd.maxfd strict 8k
xrd.network cache 5m nodnr norpipa

all.trace    all
auth.trace   all
tpc.trace    all
xrd.trace    all
xrootd.trace all
ztn.trace    all
scitokens.trace all
http.trace   all
ofs.trace    all
oss.trace    all
pss.trace    all
sec.trace    all
macaroons.trace all
